<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Espace Client - Service de Réservation</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #4CAF50;
            --primary-dark: #45a049;
            --primary-light: #e8f5e9;
            --secondary-color: #f5f5f5;
            --dark-color: #2c3e50;
            --light-color: #ffffff;
            --danger-color: #f44336;
            --warning-color: #ff9800;
            --info-color: #2196F3;
            --success-color: #4CAF50;
            --border-color: #ddd;
            --text-color: #333;
            --shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }
        
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--secondary-color);
            color: var(--text-color);
            line-height: 1.6;
        }
        
        /* Header Styles */
        header {
            background-color: var(--dark-color);
            color: var(--light-color);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow);
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 1rem;
        }
        
        .header-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--light-color);
            display: flex;
            align-items: center;
            text-decoration: none;
        }
        
        .logo i {
            margin-right: 0.5rem;
            color: var(--primary-color);
        }
        
        .user-info {
            display: flex;
            align-items: center;
        }
        
        .user-name {
            margin-right: 1rem;
            font-weight: 500;
            display: flex;
            align-items: center;
        }
        
        .user-name i {
            margin-right: 0.5rem;
            color: var(--primary-color);
        }
        
        /* Button Styles */
        .btn {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 4px;
            cursor: pointer;
            transition: var(--transition);
            text-decoration: none;
            border: none;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            font-weight: 500;
        }
        
        .btn i {
            margin-right: 0.5rem;
        }
        
        .btn-sm {
            padding: 0.25rem 0.5rem;
            font-size: 0.8rem;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            color: var(--light-color);
        }
        
        .btn-primary:hover {
            background-color: var(--primary-dark);
        }
        
        .btn-outline {
            background-color: transparent;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
        }
        
        .btn-outline:hover {
            background-color: var(--primary-light);
        }
        
        .btn-danger {
            background-color: var(--danger-color);
            color: var(--light-color);
        }
        
        .btn-danger:hover {
            background-color: #d32f2f;
        }
        
        .btn-warning {
            background-color: var(--warning-color);
            color: var(--light-color);
        }
        
        .btn-warning:hover {
            background-color: #e68a00;
        }
        
        .btn-info {
            background-color: var(--info-color);
            color: var(--light-color);
        }
        
        .btn-info:hover {
            background-color: #0b7dda;
        }
        
        /* Dashboard Layout */
        .dashboard {
            display: flex;
            margin: 1.5rem 0;
        }
        
        .sidebar {
            width: 280px;
            background-color: var(--light-color);
            border-radius: 8px;
            box-shadow: var(--shadow);
            padding: 1.5rem;
            margin-right: 1.5rem;
            height: calc(100vh - 100px);
            position: sticky;
            top: 90px;
            overflow-y: auto;
        }
        
        .sidebar-header {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .sidebar-header i {
            font-size: 1.5rem;
            margin-right: 0.5rem;
            color: var(--primary-color);
        }
        
        .sidebar-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--dark-color);
        }
        
        .sidebar-menu {
            list-style-type: none;
        }
        
        .sidebar-menu li {
            margin-bottom: 0.5rem;
        }
        
        .sidebar-menu li a {
            display: flex;
            align-items: center;
            padding: 0.75rem 1rem;
            text-decoration: none;
            color: var(--text-color);
            border-radius: 4px;
            transition: var(--transition);
        }
        
        .sidebar-menu li a i {
            margin-right: 0.5rem;
            width: 20px;
            text-align: center;
        }
        
        .sidebar-menu li a:hover,
        .sidebar-menu li a.active {
            background-color: var(--primary-light);
            color: var(--primary-color);
        }
        
        .main-content {
            flex: 1;
            background-color: var(--light-color);
            border-radius: 8px;
            box-shadow: var(--shadow);
            padding: 1.5rem;
            min-height: calc(100vh - 100px);
        }
        
        .section-title {
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .section-title h2 {
            font-size: 1.5rem;
            color: var(--dark-color);
            margin: 0;
            display: flex;
            align-items: center;
        }
        
        .section-title h2 i {
            margin-right: 0.75rem;
            color: var(--primary-color);
        }
        
        /* Search and filter controls */
        .controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .search-container {
            flex: 1;
            min-width: 250px;
            display: flex;
            position: relative;
        }
        
        .search-input {
            width: 100%;
            padding: 0.75rem;
            padding-left: 2.5rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 0.9rem;
            transition: var(--transition);
        }
        
        .search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px var(--primary-light);
        }
        
        .search-icon {
            position: absolute;
            left: 0.75rem;
            top: 50%;
            transform: translateY(-50%);
            color: #999;
        }
        
        .filters {
            display: flex;
            gap: 1rem;
        }
        
        .filter-select {
            padding: 0.5rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background-color: white;
        }
        
        /* Cards Grid Styles */
        .cards-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .agency-card {
            display: flex;
            flex-direction: column;
            height: 100%;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .agency-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }
        
        /* En-tête de carte */
        .card-header {
            padding: 1.25rem;
            border-bottom: 1px solid var(--border-color);
            background-color: #f8f9fa;
            display: flex;
            align-items: center;
        }
        
        .card-avatar {
            width: 48px;
            height: 48px;
            border-radius: 50%;
            background-color: var(--primary-light);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
        }
        
        .card-avatar i {
            font-size: 1.5rem;
            color: var(--primary-color);
        }
        
        .card-title-container {
            flex: 1;
        }
        
        .card-title {
            margin: 0;
            font-size: 1.1rem;
            font-weight: 600;
            color: var(--dark-color);
        }
        
        .card-subtitle {
            font-size: 0.9rem;
            color: #666;
            margin-top: 0.25rem;
        }
        
        /* Corps de la carte */
        .card-body {
            flex: 1;
            padding: 1.25rem;
            display: flex;
            flex-direction: column;
        }
        
        .card-details {
            margin-bottom: 1rem;
        }
        
        .card-detail {
            display: flex;
            align-items: center;
            margin-bottom: 0.75rem;
        }
        
        .card-detail i {
            width: 20px;
            margin-right: 0.75rem;
            color: #666;
            text-align: center;
        }
        
        .detail-value {
            flex: 1;
        }
        
        .card-services {
            margin-top: auto;
            border-top: 1px solid var(--border-color);
            padding-top: 1rem;
        }
        
        .services-title {
            font-weight: 600;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
        }
        
        .services-title i {
            margin-right: 0.5rem;
            color: var(--primary-color);
        }
        
        .services-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }
        
        .service-item {
            background-color: var(--primary-light);
            color: var(--primary-color);
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        /* Pied de carte */
        .card-footer {
            display: flex;
            justify-content: space-between;
            padding: 1rem;
            border-top: 1px solid var(--border-color);
            background-color: #f8f9fa;
        }
        
        .hours-open {
            display: flex;
            align-items: center;
            font-size: 0.85rem;
            color: #666;
        }
        
        .hours-open i {
            margin-right: 0.5rem;
            color: var(--primary-color);
        }
        
        /* Form Styles */
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
            color: var(--dark-color);
        }
        
        .form-control {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            font-size: 0.9rem;
            transition: var(--transition);
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px var(--primary-light);
        }
        
        select.form-control {
            background-color: white;
        }
        
        textarea.form-control {
            min-height: 120px;
            resize: vertical;
        }
        
        .form-row {
            display: flex;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .form-col {
            flex: 1;
        }
        
        /* Reservation form */
        .reservation-form {
            background-color: white;
            border-radius: 8px;
            padding: 2rem;
            margin-bottom: 2rem;
            box-shadow: var(--shadow);
        }
        
        .reservation-agency {
            display: flex;
            align-items: center;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .agency-logo {
            width: 60px;
            height: 60px;
            background-color: var(--primary-light);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 1rem;
            color: var(--primary-color);
            font-size: 1.5rem;
        }
        
        .agency-info h3 {
            margin: 0 0 0.5rem 0;
        }
        
        .agency-info p {
            margin: 0;
            color: #666;
            font-size: 0.9rem;
        }
        
        .time-slots {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            gap: 0.5rem;
            margin-top: 0.5rem;
        }
        
        .time-slot {
            padding: 0.5rem;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .time-slot:hover {
            background-color: var(--primary-light);
            border-color: var(--primary-color);
        }
        
        .time-slot.selected {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        
        .time-slot.unavailable {
            background-color: #f8f9fa;
            color: #aaa;
            cursor: not-allowed;
            text-decoration: line-through;
        }
        
        .form-actions {
            display: flex;
            justify-content: flex-end;
            gap: 1rem;
            margin-top: 2rem;
        }
        
        /* Reservation history */
        .reservation-history {
            background-color: white;
            border-radius: 8px;
            padding: 1.5rem;
        }
        
        .reservation-list {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }
        
        .reservation-item {
            border: 1px solid var(--border-color);
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            transition: var(--transition);
            box-shadow: var(--shadow);
        }
        
        .reservation-item:hover {
            transform: translateY(-3px);
        }
        
        .reservation-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid var(--border-color);
        }
        
        .reservation-title {
            font-weight: 600;
            font-size: 1.1rem;
            margin: 0;
            display: flex;
            align-items: center;
        }
        
        .reservation-title i {
            margin-right: 8px;
            color: var(--primary-color);
        }
        
        .reservation-status {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 50px;
            font-size: 0.875rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .status-pending {
            background-color: #fff8e1;
            color: #ff8f00;
        }
        
        .status-confirmed {
            background-color: #e8f5e9;
            color: #2e7d32;
        }
        
        .status-canceled {
            background-color: #ffebee;
            color: #c62828;
        }
        
        .status-completed {
            background-color: #e3f2fd;
            color: #1565c0;
        }
        
        .reservation-details {
            margin-bottom: 1rem;
        }
        
        .reservation-detail {
            display: flex;
            margin-bottom: 0.5rem;
        }
        
        .detail-label {
            width: 120px;
            font-weight: 600;
            color: #666;
        }
        
        .detail-value {
            flex: 1;
        }
        
        .reservation-description {
            background-color: #f9f9f9;
            padding: 1rem;
            border-radius: 4px;
            margin-bottom: 1rem;
        }
        
        /* Profile Section */
        .profile-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: var(--shadow);
            margin-bottom: 2rem;
        }
        
        .profile-header {
            background-color: var(--primary-light);
            padding: 2rem 1.5rem;
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
            display: flex;
            align-items: center;
        }
        
        .profile-avatar {
            width: 100px;
            height: 100px;
            background-color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 2rem;
            font-size: 3rem;
            color: var(--primary-color);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }
        
        .profile-info h3 {
            margin: 0 0 0.5rem 0;
            font-size: 1.5rem;
        }
        
        .profile-info p {
            margin: 0;
            color: #666;
        }
        
        .profile-tabs {
            display: flex;
            border-bottom: 1px solid var(--border-color);
            background-color: #f8f9fa;
        }
        
        .profile-tab {
            padding: 1rem 1.5rem;
            cursor: pointer;
            font-weight: 500;
            color: #666;
            transition: var(--transition);
            border-bottom: 2px solid transparent;
        }
        
        .profile-tab:hover {
            color: var(--primary-color);
        }
        
        .profile-tab.active {
            color: var(--primary-color);
            border-bottom-color: var(--primary-color);
        }
        
        .profile-content {
            padding: 1.5rem;
        }
        
        .profile-section {
            display: none;
        }
        
        .profile-section.active {
            display: block;
        }
        
        .profile-data {
            margin-bottom: 2rem;
        }
        
        .profile-data-item {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .profile-data-item:last-child {
            border-bottom: none;
        }
        
        .profile-data-item i {
            width: 40px;
            height: 40px;
            background-color: var(--primary-light);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-color);
            margin-right: 1rem;
        }
        
        .profile-label {
            width: 120px;
            font-weight: 600;
            color: #666;
        }
        
        .profile-value {
            flex: 1;
        }
        
        /* Help Section */
        .help-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: var(--shadow);
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        
        .faq-item {
            margin-bottom: 1.5rem;
            border-bottom: 1px solid var(--border-color);
            padding-bottom: 1.5rem;
        }
        
        .faq-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }
        
        .faq-question {
            font-weight: 600;
            margin-bottom: 0.5rem;
            color: var(--dark-color);
            display: flex;
            align-items: center;
        }
        
        .faq-question i {
            margin-right: 0.75rem;
            color: var(--primary-color);
        }
        
        .faq-answer {
            margin-left: 1.75rem;
            color: #666;
        }
        
        .help-contact {
            background-color: var(--primary-light);
            border-radius: 8px;
            padding: 1.5rem;
        }
        
        .help-contact h3 {
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
        }
        
        .help-contact h3 i {
            margin-right: 0.75rem;
            color: var(--primary-color);
        }
        
        /* Alert Styles */
        .alert {
            padding: 1rem 1.25rem;
            margin-bottom: 1.5rem;
            border: 1px solid transparent;
            border-radius: 4px;
            position: relative;
            display: flex;
            align-items: center;
        }
        
        .alert i {
            margin-right: 0.75rem;
            font-size: 1.2rem;
        }
        
        .alert-success {
            color: #155724;
            background-color: #d4edda;
            border-color: #c3e6cb;
        }
        
        .alert-danger {
            color: #721c24;
            background-color: #f8d7da;
            border-color: #f5c6cb;
        }
        
        .alert-warning {
            color: #856404;
            background-color: #fff3cd;
            border-color: #ffeeba;
        }
        
        .alert-info {
            color: #0c5460;
            background-color: #d1ecf1;
            border-color: #bee5eb;
        }
        
        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            overflow-y: auto;
            padding: 2rem 0;
        }
        
        .modal-dialog {
            max-width: 600px;
            margin: 0 auto;
            background-color: var(--light-color);
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }
        
        .modal-header {
            padding: 1.25rem;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
            background-color: var(--info-color);
            color: white;
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
        }
        
        .modal-title {
            margin: 0;
            font-size: 1.25rem;
            color: white;
        }
        
        .modal-body {
            padding: 1.5rem;
        }
        
        .modal-footer {
            padding: 1rem;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
            gap: 0.5rem;
            background-color: #f8f9fa;
            border-bottom-left-radius: 8px;
            border-bottom-right-radius: 8px;
        }
        
        .close-modal {
            background: none;
            border: none;
            font-size: 1.5rem;
            font-weight: 700;
            color: white;
            cursor: pointer;
        }
        
        .close-modal:hover {
            color: #f0f0f0;
        }
        
        /* Loader Styles */
        .loader {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 2rem;
            flex-direction: column;
        }
        
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(76, 175, 80, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary-color);
            animation: spin 1s ease-in-out infinite;
            margin-bottom: 1rem;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* No results */
        .no-results {
            text-align: center;
            padding: 3rem 0;
            color: #666;
        }
        
        .no-results i {
            font-size: 3rem;
            color: #ddd;
            margin-bottom: 1rem;
        }
        
        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            list-style-type: none;
            gap: 0.5rem;
            margin-top: 1.5rem;
        }
        
        .page-item {
            display: flex;
        }
        
        .page-link {
            padding: 0.5rem 0.75rem;
            border: 1px solid var(--border-color);
            color: var(--text-color);
            text-decoration: none;
            border-radius: 4px;
            transition: var(--transition);
        }
        
        .page-link:hover {
            background-color: #f5f5f5;
        }
        
        .page-item.active .page-link {
            background-color: var(--primary-color);
            color: white;
            border-color: var(--primary-color);
        }
        
        /* Utilities */
        .hidden {
            display: none !important;
        }
        
        .text-right {
            text-align: right;
        }
        
        .mt-2 {
            margin-top: 1rem;
        }
        
        /* Responsive Adjustments */
        @media (max-width: 1200px) {
            .cards-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
        }
        
        @media (max-width: 992px) {
            .dashboard {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                position: static;
                margin-right: 0;
                margin-bottom: 1.5rem;
            }
            
            .sidebar-menu {
                display: flex;
                flex-wrap: wrap;
                gap: 0.5rem;
            }
            
            .profile-header {
                flex-direction: column;
                text-align: center;
            }
            
            .profile-avatar {
                margin-right: 0;
                margin-bottom: 1rem;
            }
        }
        
        @media (max-width: 768px) {
            .form-row {
                flex-direction: column;
                gap: 0;
            }
            
            .time-slots {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .form-actions {
                flex-direction: column;
            }
            
            .form-actions .btn {
                width: 100%;
            }
            
            .reservation-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .reservation-status {
                margin-top: 0.5rem;
            }
            
            .profile-tabs {
                flex-wrap: wrap;
            }
            
            .profile-tab {
                flex: 1;
                text-align: center;
                padding: 0.75rem 0.5rem;
            }
            
            .profile-data-item {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .profile-label {
                width: 100%;
                margin-bottom: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container header-container">
            <a href="index.html" class="logo">
                <i class="fas fa-calendar-check"></i>
                <span>Service de Réservation</span>
            </a>
            <div class="user-info">
                <span class="user-name">
                    <i class="fas fa-user-circle"></i>
                    <span id="username">Utilisateur</span>
                </span>
                <button id="logoutBtn" class="btn btn-danger">
                    <i class="fas fa-sign-out-alt"></i> Déconnexion
                </button>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="dashboard">
            <aside class="sidebar">
                <div class="sidebar-header">
                    <i class="fas fa-th-large"></i>
                    <h3 class="sidebar-title">Tableau de bord</h3>
                </div>
                <ul class="sidebar-menu">
                    <li>
                        <a href="#" class="active" data-section="agencies-section">
                            <i class="fas fa-building"></i> Nos agences
                        </a>
                    </li>
                    <li>
                        <a href="#" data-section="reservation-history-section">
                            <i class="fas fa-history"></i> Mes réservations
                        </a>
                    </li>
                    <li>
                        <a href="#" data-section="profile-section">
                            <i class="fas fa-user"></i> Mon profil
                        </a>
                    </li>
                    <li>
                        <a href="#" data-section="help-section">
                            <i class="fas fa-question-circle"></i> Aide & support
                        </a>
                    </li>
                </ul>
            </aside>
            
            <main class="main-content">
                <!-- Section Agences -->
                <section id="agencies-section">
                    <div class="section-title">
                        <h2><i class="fas fa-building"></i> Nos agences</h2>
                    </div>
                    
                    <div id="alertContainer"></div>
                    
                    <div class="controls">
                        <div class="search-container">
                            <i class="fas fa-search search-icon"></i>
                            <input type="text" id="searchInput" class="search-input" placeholder="Rechercher par nom d'agence ou ville...">
                        </div>
                        <div class="filters">
                            <select id="cityFilter" class="filter-select">
                                <option value="">Toutes les villes</option>
                            </select>
                            <select id="serviceFilter" class="filter-select">
                                <option value="">Tous les services</option>
                            </select>
                        </div>
                    </div>
                    
                    <div id="agenciesLoader" class="loader">
                        <div class="spinner"></div>
                        <p>Chargement des agences...</p>
                    </div>
                    
                    <div id="noAgencies" class="no-results hidden">
                        <i class="fas fa-building"></i>
                        <p>Aucune agence trouvée.</p>
                    </div>
                    
                    <div id="agenciesGrid" class="cards-grid"></div>
                </section>
                
                <!-- Section Formulaire de Réservation -->
                <section id="reservation-form-section" class="hidden">
                    <div class="section-title">
                        <h2><i class="fas fa-calendar-plus"></i> Nouvelle réservation</h2>
                        <button class="btn btn-outline" id="backToAgenciesBtn">
                            <i class="fas fa-arrow-left"></i> Retour aux agences
                        </button>
                    </div>
                    
                    <div id="reservationAlert" class="alert hidden"></div>
                    
                    <div class="reservation-form">
                        <div class="reservation-agency">
                            <div class="agency-logo">
                                <i class="fas fa-building"></i>
                            </div>
                            <div class="agency-info">
                                <h3 id="selectedAgencyName">Nom de l'agence</h3>
                                <p id="selectedAgencyAddress">Adresse de l'agence</p>
                            </div>
                        </div>
                        
                        <form id="newReservationForm">
                            <input type="hidden" id="agencyId" name="agencyId">
                            
                            <div class="form-group">
                                <label for="service" class="form-label">Service requis</label>
                                <select id="service" name="service" class="form-control" required>
                                    <option value="">Sélectionnez un service</option>
                                    <!-- Les services seront ajoutés ici dynamiquement -->
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="description" class="form-label">Description</label>
                                <textarea id="description" name="description" class="form-control" placeholder="Décrivez vos besoins en détail..." required></textarea>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Date et horaire souhaités</label>
                                <div>
                                    <input type="date" id="preferredDate" name="preferredDate" class="form-control" min="" required>
                                </div>
                                <div class="time-slots" id="timeSlots">
                                    <!-- Les créneaux horaires seront ajoutés ici dynamiquement -->
                                </div>
                            </div>
                            
                            <div class="form-actions">
                                <button type="button" class="btn btn-outline" id="cancelReservationBtn">Annuler</button>
                                <button type="submit" class="btn btn-primary">Soumettre la demande</button>
                            </div>
                        </form>
                    </div>
                </section>
                
                <!-- Section Historique des Réservations -->
                <section id="reservation-history-section" class="hidden">
                    <div class="section-title">
                        <h2><i class="fas fa-history"></i> Mes réservations</h2>
                    </div>
                    
                    <div id="historyLoader" class="loader">
                        <div class="spinner"></div>
                        <p>Chargement des réservations...</p>
                    </div>
                    
                    <div id="historyAlert" class="alert hidden"></div>
                    
                    <div id="noReservations" class="no-results hidden">
                        <i class="fas fa-calendar-times"></i>
                        <p>Vous n'avez pas encore de réservations.</p>
                    </div>
                    
                    <div id="reservationList" class="reservation-list"></div>
                </section>
                
                <!-- Section Profil -->
                <section id="profile-section" class="hidden">
                    <div class="section-title">
                        <h2><i class="fas fa-user"></i> Mon profil</h2>
                    </div>
                    
                    <div id="profileAlert" class="alert hidden"></div>
                    
                    <div class="profile-card">
                        <div class="profile-header">
                            <div class="profile-avatar">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="profile-info">
                                <h3 id="profileUsername">Nom d'utilisateur</h3>
                                <p id="profileEmail">Email</p>
                            </div>
                        </div>
                        
                        <div class="profile-tabs">
                            <div class="profile-tab active" data-tab="personal-info">Informations personnelles</div>
                            <div class="profile-tab" data-tab="change-password">Modifier mot de passe</div>
                            <div class="profile-tab" data-tab="delete-account">Supprimer compte</div>
                        </div>
                        
                        <div class="profile-content">
                            <!-- Section Informations personnelles -->
                            <div class="profile-section active" id="personal-info-section">
                                <div class="profile-data">
                                    <div class="profile-data-item">
                                        <i class="fas fa-user"></i>
                                        <span class="profile-label">Nom d'utilisateur</span>
                                        <div class="profile-value" id="personalInfoUsername"></div>
                                        <button class="btn btn-sm btn-outline" id="editUsernameBtn">
                                            <i class="fas fa-edit"></i>
                                        </button>
                                    </div>
                                    
                                    <div class="profile-data-item">
                                        <i class="fas fa-envelope"></i>
                                        <span class="profile-label">Email</span>
                                        <div class="profile-value" id="personalInfoEmail"></div>
                                    </div>
                                    
                                    <div class="profile-data-item">
                                        <i class="fas fa-calendar-alt"></i>
                                        <span class="profile-label">Membre depuis</span>
                                        <div class="profile-value">Janvier 2024</div>
                                    </div>
                                    
                                    <div class="profile-data-item">
                                        <i class="fas fa-tag"></i>
                                        <span class="profile-label">Rôle</span>
                                        <div class="profile-value" id="personalInfoRole"></div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Section Modifier mot de passe -->
                            <div class="profile-section" id="change-password-section">
                                <form id="changePasswordForm">
                                    <div class="form-group">
                                        <label for="currentPassword" class="form-label">Mot de passe actuel</label>
                                        <input type="password" id="currentPassword" class="form-control" required>
                                    </div>
                                    
                                    <div class="form-row">
                                        <div class="form-col">
                                            <div class="form-group">
                                                <label for="newPassword" class="form-label">Nouveau mot de passe</label>
                                                <input type="password" id="newPassword" class="form-control" required minlength="8">
                                            </div>
                                        </div>
                                        <div class="form-col">
                                            <div class="form-group">
                                                <label for="confirmPassword" class="form-label">Confirmer le mot de passe</label>
                                                <input type="password" id="confirmPassword" class="form-control" required minlength="8">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="text-right">
                                        <button type="submit" class="btn btn-primary">
                                            <i class="fas fa-save"></i> Enregistrer
                                        </button>
                                    </div>
                                </form>
                            </div>
                            
                            <!-- Section Supprimer compte -->
                            <div class="profile-section" id="delete-account-section">
                                <div class="alert alert-warning">
                                    <i class="fas fa-exclamation-triangle"></i>
                                    <div>
                                        <strong>Attention !</strong> La suppression de votre compte est irréversible. 
                                        Toutes vos données personnelles et historique de réservations seront définitivement supprimés.
                                    </div>
                                </div>
                                
                                <form id="deleteAccountForm">
                                    <div class="form-group">
                                        <label for="deleteConfirmPassword" class="form-label">Confirmez votre mot de passe</label>
                                        <input type="password" id="deleteConfirmPassword" class="form-control" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label class="form-label">Confirmation</label>
                                        <div class="form-check">
                                            <input type="checkbox" id="deleteConfirmCheck" required>
                                            <label for="deleteConfirmCheck">
                                                Je confirme vouloir supprimer définitivement mon compte
                                            </label>
                                        </div>
                                    </div>
                                    
                                    <div class="text-right">
                                        <button type="submit" class="btn btn-danger">
                                            <i class="fas fa-trash"></i> Supprimer mon compte
                                        </button>
                                    </div>
                                </form>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Section Aide & Support -->
                <section id="help-section" class="hidden">
                    <div class="section-title">
                        <h2><i class="fas fa-question-circle"></i> Aide & support</h2>
                    </div>
                    
                    <div id="helpAlert" class="alert hidden"></div>
                    
                    <div class="help-card">
                        <h3>Foire aux questions</h3>
                        
                        <div class="faq-item">
                            <div class="faq-question">
                                <i class="fas fa-question-circle"></i>
                                Comment puis-je prendre rendez-vous ?
                            </div>
                            <div class="faq-answer">
                                Pour prendre rendez-vous, accédez à la section "Nos agences", choisissez une agence, puis cliquez sur le bouton "Réserver". Sélectionnez ensuite le service souhaité, indiquez une description de votre besoin, choisissez une date et un créneau horaire, puis soumettez votre demande.
                            </div>
                        </div>
                        
                        <div class="faq-item">
                            <div class="faq-question">
                                <i class="fas fa-question-circle"></i>
                                Comment puis-je annuler ou modifier ma réservation ?
                            </div>
                            <div class="faq-answer">
                                Vous pouvez consulter vos réservations dans la section "Mes réservations". Si votre réservation est encore en attente, vous pouvez la modifier ou l'annuler. Si elle est déjà confirmée, veuillez contacter l'agence concernée pour toute modification.
                            </div>
                        </div>
                        
                        <div class="faq-item">
                            <div class="faq-question">
                                <i class="fas fa-question-circle"></i>
                                Comment savoir si ma réservation est confirmée ?
                            </div>
                            <div class="faq-answer">
                                Après soumission de votre demande, un agent examinera votre réservation. Vous recevrez une notification par email une fois votre réservation confirmée. Vous pouvez également vérifier le statut de votre réservation dans la section "Mes réservations".
                            </div>
                        </div>
                        
                        <div class="faq-item">
                            <div class="faq-question">
                                <i class="fas fa-question-circle"></i>
                                Comment modifier mes informations personnelles ?
                            </div>
                            <div class="faq-answer">
                                Vous pouvez modifier vos informations personnelles dans la section "Mon profil". Vous pourrez y changer votre nom d'utilisateur et votre mot de passe. Notez que l'adresse email ne peut pas être modifiée pour des raisons de sécurité.
                            </div>
                        </div>
                    </div>
                    
                    <div class="help-contact mt-2">
                        <h3><i class="fas fa-envelope"></i> Contactez-nous</h3>
                        
                        <form id="contactForm">
                            <div class="form-group">
                                <label for="contactSubject" class="form-label">Sujet</label>
                                <select id="contactSubject" class="form-control" required>
                                    <option value="">Sélectionnez un sujet</option>
                                    <option value="Problème technique">Problème technique</option>
                                    <option value="Question sur ma réservation">Question sur ma réservation</option>
                                    <option value="Suggestion">Suggestion</option>
                                    <option value="Autre">Autre</option>
                                </select>
                            </div>
                            
                            <div class="form-group">
                                <label for="contactMessage" class="form-label">Message</label>
                                <textarea id="contactMessage" class="form-control" rows="5" placeholder="Décrivez votre problème ou question..." required></textarea>
                            </div>
                            
                            <div class="text-right">
                                <button type="submit" class="btn btn-primary">
                                    <i class="fas fa-paper-plane"></i> Envoyer
                                </button>
                            </div>
                        </form>
                    </div>
                </section>
            </main>
        </div>
    </div>
    
    <!-- Modal pour modifier le nom d'utilisateur -->
    <div id="editUsernameModal" class="modal">
        <div class="modal-dialog">
            <div class="modal-header">
                <h3 class="modal-title">Modifier le nom d'utilisateur</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <div id="editUsernameAlert" class="alert hidden"></div>
                <form id="editUsernameForm">
                    <div class="form-group">
                        <label for="newUsername" class="form-label">Nouveau nom d'utilisateur</label>
                        <input type="text" id="newUsername" class="form-control" required>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline cancel-modal">Annuler</button>
                <button type="button" class="btn btn-primary" id="saveUsernameBtn">Enregistrer</button>
            </div>
        </div>
    </div>
    
    <!-- Modal de confirmation -->
    <div id="confirmModal" class="modal">
        <div class="modal-dialog">
            <div class="modal-header">
                <h3 class="modal-title" id="confirmModalTitle">Confirmation</h3>
                <button class="close-modal">&times;</button>
            </div>
            <div class="modal-body">
                <p id="confirmModalMessage">Êtes-vous sûr de vouloir effectuer cette action ?</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-outline cancel-modal">Annuler</button>
                <button type="button" class="btn btn-danger" id="confirmModalBtn">Confirmer</button>
            </div>
        </div>
    </div>
    
    <script>
        // Base URL pour l'API
        const API_BASE_URL = 'http://localhost:8082';
        
        // Variables globales
        let allAgencies = [];
        let allServices = [];
        let currentAgencyId = null;
        let currentAgencyServices = [];
        let userData = null;
        let selectedTimeSlot = null;
        let currentConfirmCallback = null;
        
        // Éléments du DOM
        const usernameElement = document.getElementById('username');
        const logoutBtn = document.getElementById('logoutBtn');
        const menuItems = document.querySelectorAll('.sidebar-menu a');
        const sections = document.querySelectorAll('main section');
        
        // Éléments de la section Agences
        const searchInput = document.getElementById('searchInput');
        const cityFilter = document.getElementById('cityFilter');
        const serviceFilter = document.getElementById('serviceFilter');
        const agenciesLoader = document.getElementById('agenciesLoader');
        const noAgencies = document.getElementById('noAgencies');
        const agenciesGrid = document.getElementById('agenciesGrid');
        const alertContainer = document.getElementById('alertContainer');
        
        // Éléments de la section Formulaire de Réservation
        const backToAgenciesBtn = document.getElementById('backToAgenciesBtn');
        const newReservationForm = document.getElementById('newReservationForm');
        const selectedAgencyName = document.getElementById('selectedAgencyName');
        const selectedAgencyAddress = document.getElementById('selectedAgencyAddress');
        const agencyIdInput = document.getElementById('agencyId');
        const reservationAlert = document.getElementById('reservationAlert');
        const cancelReservationBtn = document.getElementById('cancelReservationBtn');
        const serviceSelect = document.getElementById('service');
        const timeSlots = document.getElementById('timeSlots');
        const preferredDate = document.getElementById('preferredDate');
        
        // Éléments de la section Historique
        const historyLoader = document.getElementById('historyLoader');
        const historyAlert = document.getElementById('historyAlert');
        const noReservations = document.getElementById('noReservations');
        const reservationList = document.getElementById('reservationList');
        
        // Éléments de la section Profil
        const profileAlert = document.getElementById('profileAlert');
        const profileUsername = document.getElementById('profileUsername');
        const profileEmail = document.getElementById('profileEmail');
        const personalInfoUsername = document.getElementById('personalInfoUsername');
        const personalInfoEmail = document.getElementById('personalInfoEmail');
        const personalInfoRole = document.getElementById('personalInfoRole');
        const profileTabs = document.querySelectorAll('.profile-tab');
        const profileSections = document.querySelectorAll('.profile-section');
        const editUsernameBtn = document.getElementById('editUsernameBtn');
        const changePasswordForm = document.getElementById('changePasswordForm');
        const deleteAccountForm = document.getElementById('deleteAccountForm');
        
        // Éléments du modal de modification du nom d'utilisateur
        const editUsernameModal = document.getElementById('editUsernameModal');
        const editUsernameForm = document.getElementById('editUsernameForm');
        const newUsername = document.getElementById('newUsername');
        const saveUsernameBtn = document.getElementById('saveUsernameBtn');
        const editUsernameAlert = document.getElementById('editUsernameAlert');
        
        // Éléments de la section Aide
        const helpAlert = document.getElementById('helpAlert');
        const contactForm = document.getElementById('contactForm');
        
        // Éléments du modal de confirmation
        const confirmModal = document.getElementById('confirmModal');
        const confirmModalTitle = document.getElementById('confirmModalTitle');
        const confirmModalMessage = document.getElementById('confirmModalMessage');
        const confirmModalBtn = document.getElementById('confirmModalBtn');
        
        // Initialisation au chargement de la page
        document.addEventListener('DOMContentLoaded', function() {
            // Définir la date minimale pour le sélecteur de date à aujourd'hui
            const today = new Date().toISOString().split('T')[0];
            preferredDate.min = today;
            
            // Vérifier la session
            checkSession();
            
            // Initialiser les écouteurs d'événements
            initializeEventListeners();
        });
        
        // Initialiser les écouteurs d'événements
        function initializeEventListeners() {
            // Navigation dans le menu latéral
            menuItems.forEach(item => {
                item.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    // Supprimer la classe active de tous les liens
                    menuItems.forEach(menuItem => menuItem.classList.remove('active'));
                    
                    // Ajouter la classe active au lien cliqué
                    this.classList.add('active');
                    
                    // Afficher la section correspondante
                    const sectionId = this.getAttribute('data-section');
                    sections.forEach(section => section.classList.add('hidden'));
                    document.getElementById(sectionId).classList.remove('hidden');
                    
                    // Charger les données si nécessaire
                    if (sectionId === 'agencies-section') {
                        loadAgencies();
                    } else if (sectionId === 'reservation-history-section') {
                        loadReservations();
                    } else if (sectionId === 'profile-section') {
                        loadUserProfile();
                    }
                });
            });
            
            // Recherche et filtres
            searchInput.addEventListener('input', filterAgencies);
            cityFilter.addEventListener('change', filterAgencies);
            serviceFilter.addEventListener('change', filterAgencies);
            
            // Date préférée pour la réservation
            preferredDate.addEventListener('change', function() {
                generateTimeSlots();
            });
            
            // Retour à la liste des agences
            backToAgenciesBtn.addEventListener('click', function(e) {
                e.preventDefault();
                showSection('agencies-section');
            });
            
            // Annulation de la réservation
            cancelReservationBtn.addEventListener('click', function(e) {
                e.preventDefault();
                showSection('agencies-section');
                newReservationForm.reset();
            });
            
            // Soumission du formulaire de réservation
            newReservationForm.addEventListener('submit', function(e) {
                e.preventDefault();
                createReservation();
            });
            
            // Navigation dans les onglets du profil
            profileTabs.forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabName = this.getAttribute('data-tab');
                    
                    // Activer l'onglet
                    profileTabs.forEach(t => t.classList.remove('active'));
                    this.classList.add('active');
                    
                    // Afficher la section correspondante
                    profileSections.forEach(section => section.classList.remove('active'));
                    document.getElementById(`${tabName}-section`).classList.add('active');
                });
            });
            
            // Modifier le nom d'utilisateur
            editUsernameBtn.addEventListener('click', function() {
                openEditUsernameModal();
            });
            
            // Enregistrer le nouveau nom d'utilisateur
            saveUsernameBtn.addEventListener('click', function() {
                updateUsername();
            });
            
            // Formulaire de changement de mot de passe
            changePasswordForm.addEventListener('submit', function(e) {
                e.preventDefault();
                changePassword();
            });
            
            // Formulaire de suppression de compte
            deleteAccountForm.addEventListener('submit', function(e) {
                e.preventDefault();
                showConfirmModal(
                    'Supprimer mon compte',
                    'Cette action est définitive. Êtes-vous vraiment sûr de vouloir supprimer votre compte?',
                    deleteAccount
                );
            });
            
            // Formulaire de contact
            contactForm.addEventListener('submit', function(e) {
                e.preventDefault();
                submitContactForm();
            });
            
            // Déconnexion
            logoutBtn.addEventListener('click', logout);
            
            // Fermer les modals
            document.querySelectorAll('.close-modal, .cancel-modal').forEach(button => {
                button.addEventListener('click', function() {
                    closeAllModals();
                });
            });
            
            // Fermer les modals quand on clique en dehors
            window.addEventListener('click', function(event) {
                if (event.target.classList.contains('modal')) {
                    closeAllModals();
                }
            });
        }
        
        // Vérifier la session utilisateur
        async function checkSession() {
            try {
                const response = await fetch(`${API_BASE_URL}/auth/check-session`, {
                    method: 'GET',
                    credentials: 'include'
                });
                
                const data = await response.json();
                
                if (response.ok && data.success) {
                    // Extraire les informations de l'utilisateur
                    const parts = data.message.split('|');
                    const email = parts[0];
                    const role = parts[1];
                    const username = parts.length > 2 ? parts[2] : email.split('@')[0];
                    
                    // Vérifier si l'utilisateur a le rôle USER
                    if (!role.includes('ROLE_USER')) {
                        // Rediriger vers la page appropriée
                        if (role.includes('ROLE_ADMIN')) {
                            window.location.href = 'admin-dashboard.html';
                        } else if (role.includes('ROLE_AGENT')) {
                            window.location.href = 'agent-dashboard.html';
                        } else {
                            // Utilisateur sans rôle valide, rediriger vers la page de connexion
                            window.location.href = 'auth.html';
                        }
                        return;
                    }
                    
                    // Stocker les informations de l'utilisateur
                    userData = {
                        email: email,
                        role: role,
                        username: username
                    };
                    
                    // Afficher le nom d'utilisateur
                    usernameElement.textContent = username;
                    
                    // Charger les agences
                    loadAgencies();
                } else {
                    // Session non active, rediriger vers la page de connexion
                    window.location.href = 'auth.html';
                }
            } catch (error) {
                console.error('Erreur lors de la vérification de la session:', error);
                // En cas d'erreur, rediriger vers la page de connexion
                window.location.href = 'auth.html';
            }
        }
        
        // Charger les agences
        async function loadAgencies() {
            // Afficher le loader
            agenciesLoader.classList.remove('hidden');
            noAgencies.classList.add('hidden');
            agenciesGrid.innerHTML = '';
            
            try {
                // Charger les services pour les filtres
                const servicesResponse = await fetch(`${API_BASE_URL}/api/services`, {
                    method: 'GET',
                    credentials: 'include'
                });
                
                if (servicesResponse.ok) {
                    allServices = await servicesResponse.json();
                    
                    // Remplir le filtre de services
                    serviceFilter.innerHTML = '<option value="">Tous les services</option>';
                    allServices.forEach(service => {
                        const option = document.createElement('option');
                        option.value = service.id;
                        option.textContent = service.name;
                        serviceFilter.appendChild(option);
                    });
                }
                
                // Charger les agences
                const agenciesResponse = await fetch(`${API_BASE_URL}/api/agencies/public`, {
                    method: 'GET',
                    credentials: 'include'
                });
                
                if (agenciesResponse.ok) {
                    allAgencies = await agenciesResponse.json();
                    
                    if (allAgencies.length === 0) {
                        // Aucune agence trouvée
                        noAgencies.classList.remove('hidden');
                    } else {
                        // Remplir le filtre de villes
                        const cities = [...new Set(allAgencies.map(agency => agency.city))];
                        cityFilter.innerHTML = '<option value="">Toutes les villes</option>';
                        cities.forEach(city => {
                            const option = document.createElement('option');
                            option.value = city;
                            option.textContent = city;
                            cityFilter.appendChild(option);
                        });
                        
                        // Afficher les agences
                        displayAgencies(allAgencies);
                    }
                } else {
                    // Erreur lors du chargement des agences
                    showAlert('Une erreur est survenue lors du chargement des agences.', 'danger');
                }
            } catch (error) {
                console.error('Erreur lors du chargement des agences:', error);
                showAlert('Erreur de connexion au serveur.', 'danger');
            } finally {
                // Masquer le loader
                agenciesLoader.classList.add('hidden');
            }
        }
        
        // Filtrer les agences
        function filterAgencies() {
            const searchTerm = searchInput.value.toLowerCase().trim();
            const selectedCity = cityFilter.value;
            const selectedService = serviceFilter.value;
            
            let filteredAgencies = allAgencies;
            
            // Filtrer par terme de recherche
            if (searchTerm) {
                filteredAgencies = filteredAgencies.filter(agency => 
                    agency.name.toLowerCase().includes(searchTerm) || 
                    agency.city.toLowerCase().includes(searchTerm)
                );
            }
            
            // Filtrer par ville
            if (selectedCity) {
                filteredAgencies = filteredAgencies.filter(agency => agency.city === selectedCity);
            }
            
            // Filtrer par service
            if (selectedService) {
                filteredAgencies = filteredAgencies.filter(agency => {
                    if (!agency.services || !Array.isArray(agency.services)) {
                        return false;
                    }
                    
                    return agency.services.some(service => {
                        if (typeof service === 'object' && service !== null) {
                            return service.id == selectedService;
                        } else if (typeof service === 'number') {
                            return service == selectedService;
                        }
                        return false;
                    });
                });
            }
            
            // Afficher les résultats
            if (filteredAgencies.length === 0) {
                agenciesGrid.innerHTML = '';
                noAgencies.classList.remove('hidden');
            } else {
                displayAgencies(filteredAgencies);
                noAgencies.classList.add('hidden');
            }
        }
        
        // Afficher les agences dans la grille
        function displayAgencies(agencies) {
            agenciesGrid.innerHTML = '';
            
            agencies.forEach(agency => {
                // Formater les services
                let servicesHtml = '<p>Aucun service disponible</p>';
                if (agency.services && Array.isArray(agency.services) && agency.services.length > 0) {
                    servicesHtml = '<div class="services-list">';
                    agency.services.forEach(service => {
                        let serviceName = "Service inconnu";
                        
                        if (typeof service === 'object' && service !== null) {
                            serviceName = service.name || "Sans nom";
                        } else if (typeof service === 'number') {
                            const foundService = allServices.find(s => s.id === service);
                            serviceName = foundService ? foundService.name : `Service #${service}`;
                        }
                        
                        servicesHtml += `<span class="service-item">${serviceName}</span>`;
                    });
                    servicesHtml += '</div>';
                }
                
                // Déterminer les heures d'ouverture aujourd'hui
                const businessHoursText = getBusinessHoursText(agency.businessHours);
                
                // Créer la carte
                const card = document.createElement('div');
                card.className = 'agency-card';
                
                card.innerHTML = `
                    <div class="card-header">
                        <div class="card-avatar">
                            <i class="fas fa-building"></i>
                        </div>
                        <div class="card-title-container">
                            <h3 class="card-title">${agency.name}</h3>
                            <div class="card-subtitle"><i class="fas fa-map-marker-alt"></i> ${agency.city}</div>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="card-details">
                            <div class="card-detail">
                                <i class="fas fa-map-pin"></i>
                                <div class="detail-value">${agency.address}</div>
                            </div>
                            <div class="card-detail">
                                <i class="fas fa-phone"></i>
                                <div class="detail-value">${agency.phoneNumber}</div>
                            </div>
                            <div class="card-detail">
                                <i class="fas fa-envelope"></i>
                                <div class="detail-value">${agency.email || 'Non disponible'}</div>
                            </div>
                            ${agency.description ? `
                            <div class="card-detail">
                                <i class="fas fa-info-circle"></i>
                                <div class="detail-value">${agency.description}</div>
                            </div>
                            ` : ''}
                        </div>
                        <div class="card-services">
                            <div class="services-title">
                                <i class="fas fa-concierge-bell"></i> Services proposés
                            </div>
                            ${servicesHtml}
                        </div>
                    </div>
                    <div class="card-footer">
                        <div class="hours-open">
                            <i class="fas fa-clock"></i>
                            <span>${businessHoursText}</span>
                        </div>
                        <button class="btn btn-primary book-agency-btn" data-id="${agency.id}">
                            <i class="fas fa-calendar-plus"></i> Réserver
                        </button>
                    </div>
                `;
                
                agenciesGrid.appendChild(card);
                
                // Ajouter l'écouteur d'événement pour le bouton de réservation
                card.querySelector('.book-agency-btn').addEventListener('click', function() {
                    const agencyId = this.getAttribute('data-id');
                    openReservationForm(agencyId);
                });
            });
        }
        
        // Obtenir le texte des heures d'ouverture
        function getBusinessHoursText(businessHours) {
            if (!businessHours || businessHours.length === 0) {
                return 'Horaires non disponibles';
            }
            
            // Obtenir le jour actuel (0 = Dimanche, 1 = Lundi, etc.)
            const today = new Date().getDay();
            const daysOfWeek = ['SUNDAY', 'MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY', 'SATURDAY'];
            const todayName = daysOfWeek[today];
            
            // Trouver les heures d'ouverture pour aujourd'hui
            const todayHours = businessHours.find(hour => hour.day === todayName);
            
            if (!todayHours) {
                return 'Horaires non disponibles';
            }
            
            if (todayHours.closed) {
                return 'Fermé aujourd\'hui';
            }
            
            return `Ouvert aujourd'hui: ${todayHours.openingTime} - ${todayHours.closingTime}`;
        }
        
        // Ouvrir le formulaire de réservation
        function openReservationForm(agencyId) {
            const agency = allAgencies.find(a => a.id == agencyId);
            
            if (!agency) {
                showAlert('Agence non trouvée.', 'danger');
                return;
            }
            
            // Mettre à jour les informations de l'agence sélectionnée
            selectedAgencyName.textContent = agency.name;
            selectedAgencyAddress.textContent = agency.address;
            agencyIdInput.value = agency.id;
            currentAgencyId = agency.id;
            
            // Réinitialiser le formulaire
            newReservationForm.reset();
            reservationAlert.classList.add('hidden');
            
            // Charger les services de l'agence dans le select
            serviceSelect.innerHTML = '<option value="">Sélectionnez un service</option>';
            currentAgencyServices = [];
            
            if (agency.services && Array.isArray(agency.services)) {
                agency.services.forEach(service => {
                    let serviceId, serviceName;
                    
                    if (typeof service === 'object' && service !== null) {
                        serviceId = service.id;
                        serviceName = service.name;
                    } else if (typeof service === 'number') {
                        serviceId = service;
                        const foundService = allServices.find(s => s.id === service);
                        serviceName = foundService ? foundService.name : `Service #${service}`;
                    }
                    
                    if (serviceId && serviceName) {
                        const option = document.createElement('option');
                        option.value = serviceName;
                        option.textContent = serviceName;
                        serviceSelect.appendChild(option);
                        
                        currentAgencyServices.push({
                            id: serviceId,
                            name: serviceName
                        });
                    }
                });
            }
            
            // Définir la date par défaut à aujourd'hui
            const today = new Date().toISOString().split('T')[0];
            preferredDate.value = today;
            
            // Générer les créneaux horaires disponibles
            generateTimeSlots();
            
            // Afficher la section du formulaire de réservation
            showSection('reservation-form-section');
        }
        
        // Générer les créneaux horaires
        function generateTimeSlots() {
            timeSlots.innerHTML = '';
            selectedTimeSlot = null;
            
            // Simuler des créneaux horaires
            const startHour = 9; // 9h
            const endHour = 18;  // 18h
            
            // Créer un tableau simulé d'heures réservées
            const bookedSlots = [10, 14, 16]; // Simuler des créneaux déjà réservés
            
            for (let hour = startHour; hour < endHour; hour++) {
                const timeSlotElement = document.createElement('div');
                timeSlotElement.className = 'time-slot';
                timeSlotElement.textContent = `${hour}:00`;
                timeSlotElement.dataset.time = `${hour}:00`;
                
                // Si le créneau est déjà réservé, le marquer comme indisponible
                if (bookedSlots.includes(hour)) {
                    timeSlotElement.classList.add('unavailable');
                } else {
                    // Ajouter un écouteur d'événement pour sélectionner le créneau
                    timeSlotElement.addEventListener('click', function() {
                        // Désélectionner tous les créneaux
                        document.querySelectorAll('.time-slot').forEach(slot => {
                            slot.classList.remove('selected');
                        });
                        
                        // Sélectionner le créneau cliqué
                        this.classList.add('selected');
                        selectedTimeSlot = this.dataset.time;
                    });
                }
                
                timeSlots.appendChild(timeSlotElement);
            }
        }
        
        // Créer une nouvelle réservation
        async function createReservation() {
            const service = document.getElementById('service').value;
            const description = document.getElementById('description').value;
            const preferredDate = document.getElementById('preferredDate').value;
            const agencyId = agencyIdInput.value;
            
            // Vérification des champs
            if (!service) {
                showReservationAlert('Veuillez sélectionner un service.', 'warning');
                return;
            }
            
            if (!description) {
                showReservationAlert('Veuillez fournir une description de votre besoin.', 'warning');
                return;
            }
            
            if (!preferredDate) {
                showReservationAlert('Veuillez sélectionner une date.', 'warning');
                return;
            }
            
            if (!selectedTimeSlot) {
                showReservationAlert('Veuillez sélectionner un créneau horaire.', 'warning');
                return;
            }
            
            // Formater la date préférée avec l'heure sélectionnée
            const formattedDate = `${preferredDate} ${selectedTimeSlot}`;
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/user/reservation`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        service,
                        description,
                        preferredDate: formattedDate,
                        agencyId: parseInt(agencyId)
                    }),
                    credentials: 'include'
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    showReservationAlert('Votre demande de réservation a été créée avec succès!', 'success');
                    
                    // Réinitialiser le formulaire
                    newReservationForm.reset();
                    
                    // Rediriger vers l'historique des réservations après 2 secondes
                    setTimeout(() => {
                        showSection('reservation-history-section');
                        menuItems.forEach(item => {
                            if (item.getAttribute('data-section') === 'reservation-history-section') {
                                item.classList.add('active');
                            } else {
                                item.classList.remove('active');
                            }
                        });
                        loadReservations();
                    }, 2000);
                } else {
                    showReservationAlert(data.message || 'Une erreur est survenue lors de la création de la réservation.', 'danger');
                }
            } catch (error) {
                console.error('Erreur lors de la création de la réservation:', error);
                showReservationAlert('Erreur de connexion au serveur.', 'danger');
            }
        }
        
        // Charger les réservations de l'utilisateur
        async function loadReservations() {
            // Afficher le loader
            historyLoader.classList.remove('hidden');
            noReservations.classList.add('hidden');
            historyAlert.classList.add('hidden');
            reservationList.innerHTML = '';
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/user/reservations`, {
                    method: 'GET',
                    credentials: 'include'
                });
                
                if (response.ok) {
                    const reservations = await response.json();
                    
                    if (reservations.length === 0) {
                        // Aucune réservation trouvée
                        noReservations.classList.remove('hidden');
                    } else {
                        // Afficher les réservations
                        displayReservations(reservations);
                    }
                } else {
                    // Erreur lors du chargement des réservations
                    showHistoryAlert('Une erreur est survenue lors du chargement des réservations.', 'danger');
                }
            } catch (error) {
                console.error('Erreur lors du chargement des réservations:', error);
                showHistoryAlert('Erreur de connexion au serveur.', 'danger');
            } finally {
                // Masquer le loader
                historyLoader.classList.add('hidden');
            }
        }
        
        // Afficher les réservations dans la liste
        function displayReservations(reservations) {
            reservationList.innerHTML = '';
            
            // Trier les réservations par date de création (plus récentes en premier)
            reservations.sort((a, b) => new Date(b.createdAt) - new Date(a.createdAt));
            
            reservations.forEach(reservation => {
                const listItem = document.createElement('div');
                listItem.className = 'reservation-item';
                
                // Formater les dates
                const createdDate = new Date(reservation.createdAt).toLocaleDateString('fr-FR', {
                    day: '2-digit',
                    month: '2-digit',
                    year: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                const statusClass = `status-${reservation.status.toLowerCase()}`;
                const statusText = formatStatus(reservation.status);
                
                // Trouver l'agence correspondante
                let agencyName = "Agence";
                if (reservation.agency && reservation.agency.name) {
                    agencyName = reservation.agency.name;
                }
                
                let html = `
                    <div class="reservation-header">
                        <h3 class="reservation-title">
                            <i class="fas fa-calendar-check"></i>
                            ${reservation.service}
                        </h3>
                        <span class="reservation-status ${statusClass}">${statusText}</span>
                    </div>
                    
                    <div class="reservation-details">
                        <div class="reservation-detail">
                            <span class="detail-label">Agence:</span>
                            <span class="detail-value">${agencyName}</span>
                        </div>
                        <div class="reservation-detail">
                            <span class="detail-label">Créée le:</span>
                            <span class="detail-value">${createdDate}</span>
                        </div>
                `;
                
                // Ajouter les dates de début et de fin si elles existent
                if (reservation.startDateTime) {
                    const startDate = new Date(reservation.startDateTime).toLocaleDateString('fr-FR', {
                        day: '2-digit',
                        month: '2-digit',
                        year: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                    
                    html += `
                        <div class="reservation-detail">
                            <span class="detail-label">Date de début:</span>
                            <span class="detail-value">${startDate}</span>
                        </div>
                    `;
                }
                
                if (reservation.endDateTime) {
                    const endDate = new Date(reservation.endDateTime).toLocaleDateString('fr-FR', {
                        day: '2-digit',
                        month: '2-digit',
                        year: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                    
                    html += `
                        <div class="reservation-detail">
                            <span class="detail-label">Date de fin:</span>
                            <span class="detail-value">${endDate}</span>
                        </div>
                    `;
                }
                
                if (reservation.preferredDate) {
                    html += `
                        <div class="reservation-detail">
                            <span class="detail-label">Date souhaitée:</span>
                            <span class="detail-value">${reservation.preferredDate}</span>
                        </div>
                    `;
                }
                
                html += `
                    </div>
                    
                    <div class="reservation-description">
                        ${reservation.description}
                    </div>
                `;
                
                listItem.innerHTML = html;
                reservationList.appendChild(listItem);
            });
        }
        
        // Formater le statut de la réservation
        function formatStatus(status) {
            switch (status) {
                case 'PENDING':
                    return 'En attente';
                case 'CONFIRMED':
                    return 'Confirmée';
                case 'CANCELED':
                    return 'Annulée';
                case 'COMPLETED':
                    return 'Terminée';
                default:
                    return status;
            }
        }
        
        // Charger les informations du profil utilisateur
        function loadUserProfile() {
            if (!userData) {
                return;
            }
            
            // Afficher les informations de l'utilisateur
            profileUsername.textContent = userData.username;
            profileEmail.textContent = userData.email;
            
            personalInfoUsername.textContent = userData.username;
            personalInfoEmail.textContent = userData.email;
            personalInfoRole.textContent = userData.role === 'ROLE_USER' ? 'Utilisateur' : userData.role;
        }
        
        // Ouvrir le modal de modification du nom d'utilisateur
        function openEditUsernameModal() {
            newUsername.value = userData.username;
            editUsernameAlert.classList.add('hidden');
            editUsernameModal.style.display = 'block';
        }
        
        // Mettre à jour le nom d'utilisateur
        async function updateUsername() {
            const usernameValue = newUsername.value.trim();
            
            if (!usernameValue) {
                showAlert(editUsernameAlert, 'Le nom d\'utilisateur ne peut pas être vide.', 'warning');
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/user/update-username`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        username: usernameValue
                    }),
                    credentials: 'include'
                });
                
                // Simuler une réponse positive
                // Dans un environnement réel, vous devriez utiliser la réponse du serveur
                const data = { success: true, message: 'Nom d\'utilisateur mis à jour avec succès' };
                
                if (true) { // Simuler une réponse réussie
                    // Mettre à jour les données utilisateur en local
                    userData.username = usernameValue;
                    
                    // Mettre à jour l'interface
                    usernameElement.textContent = usernameValue;
                    profileUsername.textContent = usernameValue;
                    personalInfoUsername.textContent = usernameValue;
                    
                    // Fermer le modal
                    editUsernameModal.style.display = 'none';
                    
                    // Afficher une notification
                    showAlert(profileAlert, 'Nom d\'utilisateur mis à jour avec succès!', 'success');
                } else {
                    showAlert(editUsernameAlert, data.message || 'Erreur lors de la mise à jour du nom d\'utilisateur.', 'danger');
                }
            } catch (error) {
                console.error('Erreur lors de la mise à jour du nom d\'utilisateur:', error);
                showAlert(editUsernameAlert, 'Erreur de connexion au serveur.', 'danger');
            }
        }
        
        // Changer le mot de passe
        async function changePassword() {
            const currentPassword = document.getElementById('currentPassword').value;
            const newPassword = document.getElementById('newPassword').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            // Vérifier que les mots de passe correspondent
            if (newPassword !== confirmPassword) {
                showAlert(profileAlert, 'Les mots de passe ne correspondent pas.', 'warning');
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/user/change-password`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        currentPassword,
                        newPassword
                    }),
                    credentials: 'include'
                });
                
                // Simuler une réponse positive
                const data = { success: true, message: 'Mot de passe modifié avec succès' };
                
                if (true) { // Simuler une réponse réussie
                    // Réinitialiser le formulaire
                    changePasswordForm.reset();
                    
                    // Afficher une notification
                    showAlert(profileAlert, 'Mot de passe modifié avec succès!', 'success');
                } else {
                    showAlert(profileAlert, data.message || 'Erreur lors de la modification du mot de passe.', 'danger');
                }
            } catch (error) {
                console.error('Erreur lors de la modification du mot de passe:', error);
                showAlert(profileAlert, 'Erreur de connexion au serveur.', 'danger');
            }
        }
        
        // Supprimer le compte
        async function deleteAccount() {
            try {
                const response = await fetch(`${API_BASE_URL}/api/user/delete-account`, {
                    method: 'POST',
                    credentials: 'include'
                });
                
                // Simuler une réponse positive
                const data = { success: true };
                
                if (true) { // Simuler une réponse réussie
                    // Rediriger vers la page de connexion
                    window.location.href = 'auth.html';
                } else {
                    showAlert(profileAlert, data.message || 'Erreur lors de la suppression du compte.', 'danger');
                }
            } catch (error) {
                console.error('Erreur lors de la suppression du compte:', error);
                showAlert(profileAlert, 'Erreur de connexion au serveur.', 'danger');
            }
        }
        
        // Soumettre le formulaire de contact
        async function submitContactForm() {
            const subject = document.getElementById('contactSubject').value;
            const message = document.getElementById('contactMessage').value;
            
            // Vérifier les champs
            if (!subject) {
                showAlert(helpAlert, 'Veuillez sélectionner un sujet.', 'warning');
                return;
            }
            
            if (!message) {
                showAlert(helpAlert, 'Veuillez saisir votre message.', 'warning');
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE_URL}/api/user/contact`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        subject,
                        message
                    }),
                    credentials: 'include'
                });
                
                // Simuler une réponse positive
                const data = { success: true };
                
                if (true) { // Simuler une réponse réussie
                    // Réinitialiser le formulaire
                    contactForm.reset();
                    
                    // Afficher une notification
                    showAlert(helpAlert, 'Votre message a été envoyé avec succès. Nous vous répondrons dans les plus brefs délais.', 'success');
                } else {
                    showAlert(helpAlert, data.message || 'Erreur lors de l\'envoi du message.', 'danger');
                }
            } catch (error) {
                console.error('Erreur lors de l\'envoi du message:', error);
                showAlert(helpAlert, 'Erreur de connexion au serveur.', 'danger');
            }
        }
        
        // Afficher une alerte dans un conteneur spécifique
        function showAlert(container, message, type, autoHide = true) {
            container.className = `alert alert-${type}`;
            
            // Déterminer l'icône en fonction du type
            let icon = '';
            if (type === 'success') icon = '<i class="fas fa-check-circle"></i>';
            else if (type === 'danger') icon = '<i class="fas fa-exclamation-circle"></i>';
            else if (type === 'warning') icon = '<i class="fas fa-exclamation-triangle"></i>';
            else if (type === 'info') icon = '<i class="fas fa-info-circle"></i>';
            
            container.innerHTML = `${icon} ${message}`;
            container.classList.remove('hidden');
            
            // Faire défiler jusqu'à l'alerte
            container.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // Masquer l'alerte après 5 secondes si autoHide est true
            if (autoHide) {
                setTimeout(() => {
                    container.classList.add('hidden');
                }, 5000);
            }
        }
        
        // Afficher une alerte dans le conteneur principal
        function showAlert(message, type) {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            
            // Déterminer l'icône en fonction du type
            let icon = '';
            if (type === 'success') icon = '<i class="fas fa-check-circle"></i>';
            else if (type === 'danger') icon = '<i class="fas fa-exclamation-circle"></i>';
            else if (type === 'warning') icon = '<i class="fas fa-exclamation-triangle"></i>';
            else if (type === 'info') icon = '<i class="fas fa-info-circle"></i>';
            
            alertDiv.innerHTML = `${icon} ${message}`;
            
            alertContainer.appendChild(alertDiv);
            
            // Faire défiler jusqu'à l'alerte
            alertDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // Masquer l'alerte après 5 secondes
            setTimeout(() => {
                alertDiv.remove();
            }, 5000);
        }
        
        // Afficher une alerte dans la section de réservation
        function showReservationAlert(message, type) {
            reservationAlert.className = `alert alert-${type}`;
            
            // Déterminer l'icône en fonction du type
            let icon = '';
            if (type === 'success') icon = '<i class="fas fa-check-circle"></i>';
            else if (type === 'danger') icon = '<i class="fas fa-exclamation-circle"></i>';
            else if (type === 'warning') icon = '<i class="fas fa-exclamation-triangle"></i>';
            else if (type === 'info') icon = '<i class="fas fa-info-circle"></i>';
            
            reservationAlert.innerHTML = `${icon} ${message}`;
            reservationAlert.classList.remove('hidden');
            
            // Faire défiler jusqu'à l'alerte
            reservationAlert.scrollIntoView({ behavior: 'smooth', block: 'start' });
            
            // Masquer l'alerte après 5 secondes si ce n'est pas un succès
            if (type !== 'success') {
                setTimeout(() => {
                    reservationAlert.classList.add('hidden');
                }, 5000);
            }
        }
        
        // Afficher une alerte dans la section d'historique
        function showHistoryAlert(message, type) {
            historyAlert.className = `alert alert-${type}`;
            
            // Déterminer l'icône en fonction du type
            let icon = '';
            if (type === 'success') icon = '<i class="fas fa-check-circle"></i>';
            else if (type === 'danger') icon = '<i class="fas fa-exclamation-circle"></i>';
            else if (type === 'warning') icon = '<i class="fas fa-exclamation-triangle"></i>';
            else if (type === 'info') icon = '<i class="fas fa-info-circle"></i>';
            
            historyAlert.innerHTML = `${icon} ${message}`;
            historyAlert.classList.remove('hidden');
            
            // Masquer l'alerte après 5 secondes
            setTimeout(() => {
                historyAlert.classList.add('hidden');
            }, 5000);
        }
        
        // Afficher le modal de confirmation
        function showConfirmModal(title, message, callback) {
            confirmModalTitle.textContent = title;
            confirmModalMessage.textContent = message;
            
            // Définir la fonction de rappel
            currentConfirmCallback = callback;
            
            // Ajouter l'écouteur d'événement au bouton de confirmation
            confirmModalBtn.onclick = function() {
                if (currentConfirmCallback) {
                    currentConfirmCallback();
                }
                confirmModal.style.display = 'none';
            };
            
            // Afficher le modal
            confirmModal.style.display = 'block';
        }
        
        // Fermer tous les modals
        function closeAllModals() {
            document.querySelectorAll('.modal').forEach(modal => {
                modal.style.display = 'none';
            });
        }
        
        // Afficher une section et masquer les autres
        function showSection(sectionId) {
            sections.forEach(section => {
                section.classList.add('hidden');
            });
            
            document.getElementById(sectionId).classList.remove('hidden');
            
            // Mettre à jour le menu latéral
            menuItems.forEach(item => {
                if (item.getAttribute('data-section') === sectionId) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
        }
        
        // Déconnexion
        async function logout() {
            try {
                const response = await fetch(`${API_BASE_URL}/auth/logout`, {
                    method: 'POST',
                    credentials: 'include'
                });
                
                if (response.ok) {
                    // Rediriger vers la page de connexion
                    window.location.href = 'auth.html';
                }
            } catch (error) {
                console.error('Erreur lors de la déconnexion:', error);
                // Rediriger quand même vers la page de connexion
                window.location.href = 'auth.html';
            }
        }
    </script>
</body>
</html>